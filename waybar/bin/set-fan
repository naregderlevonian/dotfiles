#!/bin/sh

CURRENT_FAN=
CURRENT_FAN_VALUE=

for hwmon_dir in /sys/devices/platform/asus-nb-wmi/hwmon/hwmon*/; do
    if [ -f "${hwmon_dir}pwm1_enable" ]; then
        CURRENT_FAN="${hwmon_dir}pwm1_enable"
        CURRENT_FAN_VALUE=$(cat $CURRENT_FAN)
        break
    fi
done

function switch_fan() {
    if echo $1 | sudo tee $CURRENT_FAN > /dev/null; then
        if [ $1 = '2' ]; then
            notify-send 'Fan Mode' 'Auto'
        else
            notify-send 'Fan Mode' 'Maximum'
        fi
    fi
}

if [ $CURRENT_FAN_VALUE = '2' ]; then
    switch_fan 0
else 
    switch_fan 2
fi
